---
title: "Dashboard"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
    source_code: embed
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(p8105.datasets)
library(plotly)
```

```{r instacart_data}
# loading dataset
data("instacart")

# tidying dataset 
instacart_df =
  instacart %>% 
  janitor::clean_names() %>% 
  filter(
    department %in% c("frozen"), 
    order_dow == 6
  )
```

Column {data-width=400}
-----------------------------------------------------------------------

### Chart A

```{r bar_plot}
instacart_df %>% 
  count(aisle) %>% 
  mutate(aisle = fct_reorder(aisle, n)) %>% 
  plot_ly(x = ~aisle, y = ~n, color = ~aisle, type = "bar", colors = "viridis") %>% 
  layout(title = "Items ordered in each aisle on day 6", 
         xaxis = list(title = "Frozen food aisle"),
         yaxis = list(title = "Number of items ordered"))
```

Column {data-width=400}
-----------------------------------------------------------------------

### Chart B

```{r box_plot}
instacart_df %>% 
  mutate(aisle = fct_reorder(aisle, order_hour_of_day)) %>% 
  plot_ly(y = ~order_hour_of_day, color = ~aisle, type = "box", colors = "viridis") %>% 
  layout(title = "Order hour of the day per aisle on day 6", 
         xaxis = list(title = "Frozen food aisle"),
         yaxis = list(title = "Order hour of the day"))
```

### Chart C

```{r histogram}
instacart_df %>% 
  plot_ly(x = ~days_since_prior_order, color = ~aisle, type = "histogram", colors = "viridis") %>% 
  layout(title = "Count of days since prior order for each frozen food aisle on day 6",
         x = "Days since prior order",
         y = "Count")
```
